(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/shopCart/submitOrder"],{"04c4":function(t,e,a){"use strict";a.r(e);var n=a("0fb0"),o=a.n(n);for(var i in n)"default"!==i&&function(t){a.d(e,t,(function(){return n[t]}))}(i);e["default"]=o.a},"0fb0":function(t,e,a){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=o(a("79cb"));function o(t){return t&&t.__esModule?t:{default:t}}function i(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function r(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?i(Object(a),!0).forEach((function(e){s(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function s(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var c=function(){a.e("components/wing-time-selector/wing-time-selector").then(function(){return resolve(a("f641"))}.bind(null,a)).catch(a.oe)},u=function(){a.e("components/number-keyboard/number-keyboard").then(function(){return resolve(a("8b55"))}.bind(null,a)).catch(a.oe)},l=function(){a.e("components/password-input/password-input").then(function(){return resolve(a("862f"))}.bind(null,a)).catch(a.oe)},f={data:function(){return{tipflag:!1,tipMsg:"",timeIndex:0,payFlag:!1,extraFlag:!1,wxFlag:!1,exDialogflag:!1,exPassword:"",dataList:[],extraPName:"",payAllMoney:0,payData:"",redId:0,yhData:"",cu_id:0}},onLoad:function(t){this.setData(t),this.getList()},onShow:function(){var e=this;e.redId=t.getStorageSync("serverRedId");var a=[{store_id:t.getStorageSync("store_id"),cu_id:t.getStorageSync("serverRedId")||0}];e.$http.post("mini/v1/service/cartsettle",{param:JSON.stringify(a)},(function(a){if(0==a.state){if(t.getStorageSync("dataList"))e.dataList=t.getStorageSync("dataList");else{var o=a.data.list;e.cu_id=a.data.cu_id||0,e.yhData=a.data,o.map((function(t){for(var e=0;e<=t.infos.length-1;e++)t.infos[e].img=n.default.globalData.imgPrefixUrl+t.infos[e].img})),e.dataList=o}e.extraPName=e.dataList[0].store_name}}))},components:{timePicker:c,numberKeyboard:u,passwordInput:l},computed:{times:function(){var t=new Date,e=t.getFullYear(),a=(t.getMonth()+1).toString().padStart(2,"0"),n=t.getDate().toString().padStart(2,"0");return e+"-"+a+"-"+n}},methods:{jump:function(e){1==e&&t.navigateTo({url:"/pages/shopCart/ticket?serverShopId="+this.dataList[0].store_id+"&payAllMoney="+this.yhData.total_price+"&cu_id="+this.cu_id})},keepTwoDecimalFull:function(t){var e=parseFloat(t);if(isNaN(e))return!1;e=Math.round(100*t)/100;var a=e.toString(),n=a.indexOf(".");n<0&&(n=a.length,a+=".");while(a.length<=n+2)a+="0";this.yhData.total_price=a},getTime:function(t){this.timeIndex=t},getList:function(){var t=this;t.$http.post("mini/v1/service/cartsettle",{},(function(e){if(0==e.state){var a=e.data.list;t.yhData=e.data,a.map((function(t){t.timeValue="";for(var e=0;e<=t.infos.length-1;e++)t.infos[e].img=n.default.globalData.imgPrefixUrl+t.infos[e].img})),t.dataList=a,t.extraPName=t.dataList[0].store_name}}))},btnConfirm:function(e){console.log(e),e.month=e.month.padStart(2,0),e.day=e.day.padStart(2,0),e.hour=e.hour.padStart(2,0),e.minute=e.minute.padStart(2,0);var a=e.year+"-"+e.month+"-"+e.day+" "+e.hour+":"+e.minute,n=r(r({},this.dataList[this.timeIndex]),{},{timeValue:a});this.$set(this.dataList,this.timeIndex,n),t.setStorageSync("dataList",this.dataList)},payWayClick:function(t){1==t?(this.extraFlag=!this.extraFlag,this.wxFlag=!1):2==t&&(this.wxFlag=!this.wxFlag,this.extraFlag=!1)},payBtn:function(){var e=this;this.payFlag=!1,e.wxFlag?(e.wxFlag=!1,e.sendOrder(1)):e.extraFlag&&e.$http.post("mini/v1/user/paypasswordcheck",{},(function(a){0==a.state?(e.sendOrder(2),e.exPassword="",e.extraFlag=!1):1==a.state&&t.showModal({title:"提示",content:"您还没有设置交易密码",confirmText:"设置密码",success:function(e){e.confirm?t.navigateTo({url:"/pages/personCenter/mySetting/mySetting"}):e.cancel&&console.log("用户点击取消")}})}))},wxPay:function(){var e=this,a=function(a){e.wxPayment({result:a,success:function(e){t.redirectTo({url:"/pages/personCenter/myOpinion/opinionSuccess?typesName=11"})},fail:function(e){t.redirectTo({url:"/pages/personCenter/myOpinion/opinionSuccess?typesName=12"})}})};e.$http.post("mini/v1/payment/servicepay",{pay_type:1,order_sn:e.payData.order_sn,pay_price:e.payData.total_price},(function(t){if(0==t.state){var e=t.data;a(e)}}))},extraPay:function(){var e=this;console.log(e.payData),console.log("that.payDat2"),e.$http.post("mini/v1/payment/servicepay",{pay_type:2,order_sn:e.payData.order_sn,pay_price:e.payData.total_price,pay_password:e.exPassword},(function(a){e.exDialogflag=!1,e.exPassword="",0==a.state?t.redirectTo({url:"/pages/personCenter/myOpinion/opinionSuccess?typesName=10"}):3==a.state?t.showModal({title:"提示",content:"支付密码输入错误",confirmText:"重新输入",success:function(a){a.confirm?(e.exPassword="",e.exDialogflag=!0):a.cancel&&t.switchTab({url:"/pages/shopCart/shopCart"})}}):1==a.state&&(e.exPassword="",e.exDialogflag=!1,e.tipflag=!0,e.tipMsg=a.msg,setTimeout((function(){e.tipflag=!1}),3e3))}))},KeyboarOpen:function(t){this.$refs.KeyboarHid.open()},getPsd:function(t){this.exPassword=t,6==this.exPassword.length&&(this.$refs.KeyboarHid.close(),this.extraPay())},exDialogClick:function(){this.exDialogflag=!1,this.$refs.KeyboarHid.close()},sendOrder:function(t){var e=this,a=[],n=this.dataList.every((function(t){return a.push({store_id:t.store_id,service_ids:t.service_ids,appo_time:t.timeValue,cu_id:e.redId||0,order:e.orderCode||0}),""!=t.timeValue}));console.log(n),n?e.$http.post("mini/v1/service/createorder",{param:JSON.stringify(a)},(function(a){0==a.state&&(e.payData=a.data,e.orderCode=a.data.order_sn,console.log(e.payData),console.log("11111that.payData"),1==t?e.wxPay():2==t&&(e.exDialogflag=!0))})):(e.tipflag=!0,e.tipMsg="选择预约时间",setTimeout((function(){e.tipflag=!1}),3e3))}}};e.default=f}).call(this,a("543d")["default"])},"1e2a":function(t,e,a){"use strict";a.r(e);var n=a("f766"),o=a("04c4");for(var i in o)"default"!==i&&function(t){a.d(e,t,(function(){return o[t]}))}(i);a("cd45");var r,s=a("f0c5"),c=Object(s["a"])(o["default"],n["b"],n["c"],!1,null,"4ffd8aeb",null,!1,n["a"],r);e["default"]=c.exports},"64c8":function(t,e,a){},"79cb":function(t,e,a){"use strict";a.r(e);var n=a("ae71");for(var o in n)"default"!==o&&function(t){a.d(e,t,(function(){return n[t]}))}(o);a("ac07");var i,r,s,c,u=a("f0c5"),l=Object(u["a"])(n["default"],i,r,!1,null,null,null,!1,s,c);e["default"]=l.exports},a815:function(t,e,a){},ac07:function(t,e,a){"use strict";var n=a("64c8"),o=a.n(n);o.a},ae71:function(t,e,a){"use strict";a.r(e);var n=a("ff90"),o=a.n(n);for(var i in n)"default"!==i&&function(t){a.d(e,t,(function(){return n[t]}))}(i);e["default"]=o.a},bc1d:function(t,e,a){"use strict";(function(t){a("edce");n(a("66fd"));var e=n(a("1e2a"));function n(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,a("543d")["createPage"])},cd45:function(t,e,a){"use strict";var n=a("a815"),o=a.n(n);o.a},f766:function(t,e,a){"use strict";a.d(e,"b",(function(){return o})),a.d(e,"c",(function(){return i})),a.d(e,"a",(function(){return n}));var n={passwordInput:function(){return a.e("components/password-input/password-input").then(a.bind(null,"862f"))},numberKeyboard:function(){return a.e("components/number-keyboard/number-keyboard").then(a.bind(null,"8b55"))}},o=function(){var t=this,e=t.$createElement;t._self._c;t._isMounted||(t.e0=function(e){e.stopPropagation(),t.payFlag=!0},t.e1=function(e){e.stopPropagation(),t.payFlag=!1},t.e2=function(e){e.stopPropagation(),t.payFlag=!1})},i=[]},ff90:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(a("66fd")),o=i(a("6c44"));function i(t){return t&&t.__esModule?t:{default:t}}Object.assign(n.default.prototype,o.default);var r={globalData:{imgPrefixUrl:"https://chikehometest.hzbixin.cn"},onLaunch:function(){console.log("App Launch")},onShow:function(){console.log("App Show")},onHide:function(){console.log("App Hide")}};e.default=r}},[["bc1d","common/runtime","common/vendor"]]]);